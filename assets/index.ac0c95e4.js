import{j as g,F as D,r as u,A as S,R as N,a as w}from"./vendor.75cedffc.js";const b=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(e){if(e.ep)return;e.ep=!0;const t=s(e);fetch(e.href,t)}};b();const d={"Blade sharpening":{streamName:"blade.sharpening",window:5},"Oil change":{streamName:"oil.change",window:5},"Oil filter change":{streamName:"oil.filter.change",window:5},"Air filter":{streamName:"air.filter",window:5},"Cleaning / Powerwash":{streamName:"cleaning.powerwash",window:5}},x=r=>{const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(r),e=a[n.getDay()],t=s[n.getMonth()];return`Last service: ${e}, ${t} ${n.getDate()}`},_=(r,a)=>{let n=v(r)+a;const e=v(Date.now());n>365&&e<=a&&(n=n-365);const t=n-e;return t===0?["Next service: by today","today"]:t>0?[`Next service: in ${t} day(s)`,"good"]:[`Next service: by ${t*-1} day(s) ago`,"overdue"]},v=r=>{var a=new Date(r),s=new Date(a.getFullYear(),0,0),n=a-s+(s.getTimezoneOffset()-a.getTimezoneOffset())*60*1e3,e=1e3*60*60*24,t=Math.floor(n/e);return t},M="_bottom_f3h0n_13",O="_top_f3h0n_23",L="_time_f3h0n_33",A="_btn_f3h0n_46",T="_item_f3h0n_1";var c={"item-container":"_item-container_f3h0n_1",bottom:M,top:O,time:L,"time-today":"_time-today_f3h0n_39","time-overdue":"_time-overdue_f3h0n_42",btn:A,item:T};const i=g.exports.jsx,y=g.exports.jsxs,h=({name:r,lastServiceDate:a,nextServiceDate:s,serviceStatus:n,maintenanceType:e})=>{const t=async()=>{await(await D.getCurrentDevice()).sendCommand("perform.maintenance",e)};return y("div",{className:c["item-container"],children:[y("div",{className:c.top,children:[i("span",{className:c.time,children:a}),i("span",{className:`${c.time} ${c[`time-${n}`]}`,children:s})]}),y("div",{className:c.bottom,children:[i("span",{className:c.item,children:r}),i("button",{onClick:t,className:c.btn,children:"Mark Complete"})]})]})},$=({device:r})=>{const[a,s]=u.exports.useState(),[n,e]=u.exports.useState([]);u.exports.useEffect(()=>{t()},[r]);const t=async()=>{if(r){const l=(await r.getLatestTelemetry()).filter(m=>m.currentValue==="Maintenance performed"),f=l.map(m=>m.streamName);s(l),e(f)}};return i("div",{children:!!a&&Object.keys(d).map((o,l)=>{if((n==null?void 0:n.length)>0){const f=n.indexOf(d[o].streamName);if(f>=0){const m=new Date(a[f].currentValueTime),p=_(m,d[o].window);return i(h,{name:o,lastServiceDate:x(m)||"--:--",nextServiceDate:p[0]||"--:--",serviceStatus:p[1],maintenanceType:d[o].streamName},l)}}return i(h,{name:o,lastServiceDate:"Last service: More than 20 days ago",nextServiceDate:"Next Service: Overdue for more than 15 days",serviceStatus:"overdue",maintenanceType:d[o].streamName},l)})})},C=()=>{const[r,a]=u.exports.useState();u.exports.useEffect(()=>{s()},[]);const s=async()=>{if(await S.waitTilAuthenticated()){const n=await D.getCurrentDevice();a(n)}};return i("div",{className:"App",children:i($,{device:r})})};N.render(i(w.StrictMode,{children:i(C,{})}),document.getElementById("root"));
