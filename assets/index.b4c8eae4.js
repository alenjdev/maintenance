import{j as g,r as d,A as S,F as D,R as N,a as w}from"./vendor.75cedffc.js";const b=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}};b();const f={"Blade sharpening":{streamName:"blade.sharpening",window:5},"Oil change":{streamName:"oil.change",window:5},"Oil filter change":{streamName:"oil.filter.change",window:5},"Air filter":{streamName:"air.filter",window:5},"Cleaning / Powerwash":{streamName:"cleaning.powerwash",window:5}},x=r=>{const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["January","February","March","April","May","June","July","August","September","October","November","December"],t=new Date(r),e=a[t.getDay()],n=s[t.getMonth()];return`Last service: ${e}, ${n} ${t.getDate()}`},_=(r,a)=>{let t=p(r)+a;const e=p(Date.now());t>365&&e<=a&&(t=t-365);const n=t-e;return n===0?["Next service: by today","today"]:n>0?[`Next service: in ${n} day(s)`,"good"]:[`Next service: by ${n*-1} day(s) ago`,"overdue"]},p=r=>{var a=new Date(r),s=new Date(a.getFullYear(),0,0),t=a-s+(s.getTimezoneOffset()-a.getTimezoneOffset())*60*1e3,e=1e3*60*60*24,n=Math.floor(t/e);return n},M="_bottom_f3h0n_13",O="_top_f3h0n_23",L="_time_f3h0n_33",A="_btn_f3h0n_46",$="_item_f3h0n_1";var c={"item-container":"_item-container_f3h0n_1",bottom:M,top:O,time:L,"time-today":"_time-today_f3h0n_39","time-overdue":"_time-overdue_f3h0n_42",btn:A,item:$};const o=g.exports.jsx,y=g.exports.jsxs,v=({name:r,lastServiceDate:a,nextServiceDate:s,serviceStatus:t})=>y("div",{className:c["item-container"],children:[y("div",{className:c.top,children:[o("span",{className:c.time,children:a}),o("span",{className:`${c.time} ${c[`time-${t}`]}`,children:s})]}),y("div",{className:c.bottom,children:[o("span",{className:c.item,children:r}),o("button",{className:c.btn,children:"Mark Complete"})]})]}),j=({device:r})=>{const[a,s]=d.exports.useState(),[t,e]=d.exports.useState([]);d.exports.useEffect(()=>{n()},[r]);const n=async()=>{if(r){const m=(await r.getLatestTelemetry()).filter(l=>l.currentValue==="Maintenance performed"),u=m.map(l=>l.streamName);s(m),e(u)}};return o("div",{children:!!a&&Object.keys(f).map((i,m)=>{if((t==null?void 0:t.length)>0){const u=t.indexOf(f[i].streamName);if(u>=0){const l=new Date(a[u].currentValueTime),h=_(l,f[i].window);return o(v,{name:i,lastServiceDate:x(l)||"--:--",nextServiceDate:h[0]||"--:--",serviceStatus:h[1]},m)}}return o(v,{name:i,lastServiceDate:"Last service: More than 20 days ago",nextServiceDate:"Next Service: Overdue for more than 15 days",serviceStatus:"overdue"},m)})})},T=()=>{const[r,a]=d.exports.useState();d.exports.useEffect(()=>{s()},[]);const s=async()=>{if(await S.waitTilAuthenticated()){const t=await D.getCurrentDevice();a(t)}};return o("div",{className:"App",children:o(j,{device:r})})};N.render(o(w.StrictMode,{children:o(T,{})}),document.getElementById("root"));
